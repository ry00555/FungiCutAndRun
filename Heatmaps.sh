#!/bin/bash
#SBATCH --job-name=Heatmaps
#SBATCH --partition=batch
#SBATCH --mail-type=ALL
#SBATCH --mail-user=ry00555@uga.edu
#SBATCH --ntasks=1
#SBATCH --mem=10gb
#SBATCH --time=08:00:00
#SBATCH --output=Heatmaps.%j.out
#SBATCH --error=Heatmaps.%j.err

cd $SLURM_SUBMIT_DIR

ml deepTools/3.5.2-foss-2022a

#computeMatrix scale-regions -p 12 --startLabel "5'" --endLabel "3'" -S /scratch/ry00555/RTT109PaperFigures/BigWigs/131-22_ChIP_WT_H3K27me2me3_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-52_ChIP_WT_H3K27me3_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-67_ChIP_WT_H3K27me2me3_Rep2.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-87_ChIP_WT_H3K27me2me3_Rep3.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-18_ChIP_WT_H3K27me2_3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-3_ChIP_S2_WT_H3K27me3_Rep5_Nc_24hrVMMON_S3_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/134-28_ChIP_WT_H3K27me3_Rep2.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/134-2_ChIP_WT_H3K27me3_Rep2.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-27_ChIP_WT_H3K27me3_Rep1.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/137-27_ChIP_WT_H3K27me3_Rep3_S27_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-10_ChIP_WT_H3K27me3_Rep3.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-76_ChIP_WT_H3K27me3__S76_L007_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/137-28_ChIP_WT_H3K36me3_Rep3_S28_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-11_ChIP_WT_H3K36me3_Rep3.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-77_ChIP_WT_H3K36me3__S77_L007_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-27_ChIP_WT_H3K36me2_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-54_ChIP_WT_H3K36me3_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-72_ChIP_WT_H3K36me2_Rep2.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-37_ChIP_WT_input_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-77_ChIP_WT_input_Rep2.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-92_ChIP_WT_input_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/132-17_ChIP_WT_H4K16ac.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-16_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-23_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-24_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-25_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw -R "/scratch/ry00555/neurospora.bed" --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenes.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenes.matrix.txt --sortRegions keep --missingDataAsZero -bs 10

#plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenes.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllWTAllModsAllGenes_V1_nosorting.png --samplesLabel 131-22-H3K27me2me3 131-52-H3K27me3 131-67-H3K27me2me3 131-87-H3K27me2me3 135-18-H3K27me2 147-3-H3K27me3 134-28-H3K27me3 134-2-H3K27me3 135-27-H3K27me3 137-27-H3K27me3 142-10-H3K27me3 142-76-H3K27me3 137-28-H3K36me3 142-11-H3K36me3 142-77-H3K36me3 131-27-H3K36me2 131-54-H3K36me3 131-72-H3K36me2 131-37-input 131-77-input 131-92-input 132-17-H4K16ac 135-16-H3K9me3 135-23-H3K9me3 135-24-H3K9me3 135-25-H3K9me3 --hclust 1


#computeMatrix scale-regions -p 12 --startLabel "5'" --endLabel "3'" -S /scratch/ry00555/RTT109PaperFigures/BigWigs/135-16_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-23_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-24_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-25_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw -R "/scratch/ry00555/neurospora.bed" --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenesH3K9me3only.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenesH3K9me3only.matrix.txt --sortRegions keep --missingDataAsZero -bs 10

#plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllWTallgenesH3K9me3only.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllWT_H3K9me3_AllGenes_V1_nosorting.png --samplesLabel 135-16-H3K9me3 135-23-H3K9me3 135-24-H3K9me3 135-25-H3K9me3 --hclust 1

#computeMatrix scale-regions -p 12 -S /scratch/ry00555/RTT109PaperFigures/BigWigs/135-16_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-23_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-25_ChIP_WT_H3K9me3.bin_25.smooth_75Bulk.bw -R "/scratch/ry00555/Figure2G_K9regions_Scaledcenter_FileToCheckOrderFINAL.txt." --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K9regions_H3K9me3only.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K9regions_H3K9me3only.matrix.txt --sortRegions keep --missingDataAsZero -bs 10 	-b 1000 -a 1000

plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K9regions_H3K9me3only.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllWT_K9regions_H3K9me3only_V2_nosort.png --samplesLabel 135-16-H3K9me3 135-23-H3K9me3 135-25-H3K9me3 --startLabel "5'" --endLabel "3'"

#computeMatrix scale-regions -p 12  -S /scratch/ry00555/RTT109PaperFigures/BigWigs/131-22_ChIP_WT_H3K27me2me3_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-3_ChIP_S2_WT_H3K27me3_Rep5_Nc_24hrVMMON_S3_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-10_ChIP_WT_H3K27me3_Rep3.bin_25.smooth_50_Q30.bw -R "/scratch/ry00555/heatmapPRC2genes.bed" --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K27genes_K27Only.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K27genes_K27Only.matrix.txt --sortRegions keep --missingDataAsZero -bs 10 	-b 1000 -a 1000

#plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_K27genes_K27Only.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllWT_K27genes_K27Only_V1.png --samplesLabel 131-22-H3K27me3 147-3-H3K27me3 142-10-H3K27me3 --zMax 8 10 10 --startLabel "5'" --endLabel "3'"

#computeMatrix scale-regions -p 12  -S /scratch/ry00555/RTT109PaperFigures/BigWigs/131-54_ChIP_WT_H3K36me3_Rep1.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/131-72_ChIP_WT_H3K36me2_Rep2.bw -R "/scratch/ry00555/neurospora.bed" --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_AllGenes_K36Only.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_AllGenes_K36Only.matrix.txt --sortRegions keep --missingDataAsZero -bs 10 	-b 1000 -a 1000

#plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllWT_AllGenes_K36Only.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllWT_AllGenes_K36Only_v2.png --samplesLabel 131-54-H3K36me3 131-72-H3K36me3 --heatmapHeight 9 --heatmapWidth 4 --zMax 8 10 10 --startLabel "5'" --endLabel "3'"


#computeMatrix scale-regions -p 12  -S /scratch/ry00555/RTT109PaperFigures/BigWigs/111_2_ChIP_dRTT109_K27me2_3_Rep1_S2_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/111_3_ChIP_dRTT109_K27me3_Rep1_S3_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/133-80_ChIP_rtt109_hph_Input_Rep1_S77_L001_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/133-82_ChIP_rtt109_hph_H3K36me3.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-80_ChIP_rtt109_Input_Rep2_S76_L001_R1_001_val_1.fq.gz.bin_25.smooth_50Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-81_ChIP_rtt109_H3K9me3_Rep2_S77_L001_R1_001_val_1.fq.gz.bin_25.smooth_50Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-81_ChIP_rtt109_H3K9me3_Rep2_S77_L001_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-82_ChIP_rtt109_acetylatedLysine_Rep2_S78_L001_R1_001_val_1.fq.gz.bin_25.smooth_50Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-83_ChIP_rtt109_H3K27me3_Rep2_S79_L001_R1_001_val_1.fq.gz.bin_25.smooth_50Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/135-83_ChIP_rtt109_H3K27me3_Rep2_S79_L001_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/137-83_ChIP_rtt109_H3K27me3_Rep3_S78_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/137-84_ChIP_rtt109_H3K36me3_Rep3_S79_R1_001_val_1.fq.gz.bin_25.smooth_75Bulk.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-85_ChIP_S543_H3K27me3.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-86_ChIP_S543_Input.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-79_ChIP_rtt109_H3K27me3__S79_L007_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-80_ChIP_rtt109_H3K36me3__S80_L007_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/142-84_ChIP_H3K36me3.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-53_ChIP_337rtt109P3_rtt109hph_Input_Rep1_Nc_24hrVMMON_S53_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-55_ChIP_337rtt109P3_rtt109hph_H3K27me3_Rep1_Nc_24hrVMMON_S55_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-56_ChIP_337rtt109P3_rtt109hph_H3K36me3_Rep1_Nc_24hrVMMON_S56_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-59_ChIP_534rtt109P7_rtt109hph_H3K27me3_Rep1_Nc_24hrVMMON_S59_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw /scratch/ry00555/RTT109PaperFigures/BigWigs/147-60_ChIP_534rtt109P7_rtt109hph_H3K36me3_Rep1_Nc_24hrVMMON_S60_L001_R1_001_val_1.fq.gz.bin_25.smooth_50_Q30.bw -R "/scratch/ry00555/neurospora.bed" --skipZeros -o /scratch/ry00555/RTT109PaperFigures/Matrices/AllRTT109_allgenes.gz --outFileNameMatrix /scratch/ry00555/RTT109PaperFigures/Matrices/AllRTT109_allgenes.matrix.txt --sortRegions keep --missingDataAsZero -bs 10

plotHeatmap -m /scratch/ry00555/RTT109PaperFigures/Matrices/AllRTT109_allgenes.gz -out /scratch/ry00555/RTT109PaperFigures/Heatmaps/AllRTT109_allgenes_V1_nosorting.png --samplesLabel 111-3-K27me3 133-80-Input 133-82-H3K36me3 135-80-Input 135-81-H3K9me3 135-81-H3K9me3 135-82-acetylatedLysine 135-83-H3K27me3 135-83-H3K27me3 137-83-H3K27me3 137-84-H3K36me3 142-85-H3K27me3 142-86-Input 142-79-H3K27me3 142-80-H3K36me3 142-84-H3K36me3 147-53-Input 147-55-H3K27me3 147-56-H3K36me3 147-59-H3K27me3 147-60-H3K36me3 --hclust 1 --startLabel "5'" --endLabel "3'"
